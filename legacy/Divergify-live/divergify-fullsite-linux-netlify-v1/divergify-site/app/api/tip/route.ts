import { NextRequest, NextResponse } from 'next/server'; import Stripe from 'stripe'; export async function POST(req:NextRequest){ const form=await req.formData(); const a=String(form.get('amount')||'small'); const amount=a==='large'?1500:a==='medium'?700:300; const key=process.env.STRIPE_SECRET_KEY||''; if(!key) return NextResponse.json({error:'stripe key missing'},{status:500}); const stripe=new Stripe(key,{apiVersion:'2024-06-20'}); const s=await stripe.checkout.sessions.create({mode:'payment', line_items:[{price_data:{currency:'usd',product_data:{name:'Tip'},unit_amount:amount},quantity:1}], success_url:(process.env.AUTH_URL||'http://localhost:3000')+'/support', cancel_url:(process.env.AUTH_URL||'http://localhost:3000')+'/support'}); return NextResponse.redirect(s.url||'/support',{status:303}); }